<!doctype html>
<html lang="zh-HK">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ç«‹é«”åœ–å½¢é…å°é€šé—œï¼ˆåœ–ç‰‡ç‰ˆï¼‰</title>
  <style>
    :root{
      --bg:#f6f7fb; --card:#fff; --ink:#111827; --muted:#6b7280;
      --line:#e5e7eb; --good:#16a34a; --bad:#dc2626; --accent:#2563eb;
    }
    body{ margin:0; font-family:"Noto Sans TC","PingFang TC","Microsoft JhengHei",system-ui,sans-serif; background:var(--bg); color:var(--ink); }
    header{ padding:16px 18px; background:#fff; border-bottom:1px solid var(--line); }
    header h1{ margin:0; font-size:18px; }
    header p{ margin:6px 0 0; color:var(--muted); font-size:13px; line-height:1.4; }

    .wrap{ max-width:1100px; margin:0 auto; padding:16px 18px 28px; }
    .top{ display:grid; grid-template-columns: 1.15fr 1.85fr; gap:14px; align-items:start; }
    .panel{ background:var(--card); border:1px solid var(--line); border-radius:14px; box-shadow:0 8px 24px rgba(0,0,0,.06); }
    .panel .hd{ padding:12px 14px; border-bottom:1px solid var(--line); display:flex; justify-content:space-between; align-items:center; gap:10px; }
    .panel .hd .meta{ font-size:13px; color:var(--muted); }
    .panel .bd{ padding:12px 14px; }

    .controls{ display:flex; gap:8px; flex-wrap:wrap; }
    button{
      border:1px solid var(--line); background:#fff; padding:10px 12px; border-radius:12px;
      font-size:14px; cursor:pointer;
    }
    button.primary{ background:var(--accent); color:#fff; border-color:transparent; }
    button:disabled{ opacity:.5; cursor:not-allowed; }

    /* å·¦é‚Šåœ–ç‰‡ */
    #imgWrap{
      height:360px; border-radius:12px; overflow:hidden;
      background:#ffffff; display:flex; align-items:center; justify-content:center;
      border:1px solid var(--line);
    }
    #shapeImg{
      width:100%; height:100%;
      object-fit:contain; display:block;
      background:#ffffff;
    }

    .status{
      margin-top:10px; padding:10px 12px; border-radius:12px;
      border:1px dashed var(--line); color:var(--muted); font-size:14px; line-height:1.5;
    }
    .status.good{ border-color:rgba(22,163,74,.35); background:rgba(22,163,74,.07); color:#0f5f2b; }
    .status.bad{ border-color:rgba(220,38,38,.35); background:rgba(220,38,38,.07); color:#7f1d1d; }

    .grid{ display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:12px; }
    .group{ padding:12px 12px 14px; }
    .group h3{ margin:0 0 8px; font-size:14px; color:#111827; }
    .opts{ display:flex; flex-wrap:wrap; gap:8px; }
    .opt{
      padding:10px 10px; border-radius:12px; border:1px solid var(--line); background:#fff;
      font-size:14px; cursor:pointer; user-select:none;
    }
    .opt.selected{ outline:2px solid rgba(37,99,235,.35); border-color:rgba(37,99,235,.55); }

    .footerRow{
      display:flex; gap:10px; align-items:center; justify-content:space-between;
      padding:12px 14px; border-top:1px solid var(--line);
    }
    .score{ font-size:13px; color:var(--muted); }
    .hint{ font-size:13px; color:var(--muted); }

    @media (max-width:900px){
      .top{ grid-template-columns: 1fr; }
      #imgWrap{ height:320px; }
    }
  </style>
</head>
<body>
<header>
  <h1>ç«‹é«”åœ–å½¢é…å°é€šé—œï¼ˆåœ–ç‰‡ç‰ˆï¼šä¸‰ï½äº”è§’éŒï¼ä¸‰ï½äº”è§’æŸ±ï¼‰</h1>
  <p>å·¦é‚Šé¡¯ç¤ºç«‹é«”åœ–å½¢åœ–ç‰‡ï¼›å³é‚Šå››é¡å­—å¡å„æ€ä¸€å¼µã€‚å››é¡å…¨éƒ¨æ­£ç¢ºå…ˆé€šé—œã€‚</p>
</header>

<div class="wrap">
  <div class="top">
    <!-- å·¦ï¼šåœ–ç‰‡ -->
    <div class="panel">
      <div class="hd">
        <div>
          <div style="font-weight:700;">ç«‹é«”åœ–å½¢åœ–ç‰‡</div>
          <div class="meta" id="shapeMeta">è«‹è§€å¯Ÿå·¦é‚Šåœ–å½¢ï¼Œå®Œæˆå³é‚Šé…å°ã€‚</div>
        </div>
        <div class="controls">
          <button id="btnNew">ä¸‹ä¸€é¡Œï¼ˆéš¨æ©Ÿï¼‰</button>
          <button id="btnReset">é‡è¨­é¸æ“‡</button>
        </div>
      </div>
      <div class="bd">
        <div id="imgWrap">
          <img id="shapeImg" alt="ç«‹é«”åœ–å½¢" />
        </div>
        <div id="status" class="status">æç¤ºï¼šå››é¡éƒ½è¦æ€å…ˆå¯ä»¥æäº¤ã€‚</div>
      </div>
    </div>

    <!-- å³ï¼šå­—å¡ -->
    <div class="panel">
      <div class="hd">
        <div style="font-weight:700;">å››é¡å­—å¡é…å°</div>
        <div class="meta">æ¯é¡æ€ 1 å¼µ â†’ æäº¤</div>
      </div>

      <div class="bd">
        <div class="grid">
          <div class="panel group">
            <h3>A é¡ï¼šæŸ±é«”ï¼éŒ</h3>
            <div class="opts" id="groupA"></div>
          </div>
          <div class="panel group">
            <h3>B é¡ï¼šå´é¢å½¢ç‹€</h3>
            <div class="opts" id="groupB"></div>
          </div>
          <div class="panel group">
            <h3>C é¡ï¼šç¸½é¢æ•¸</h3>
            <div class="opts" id="groupC"></div>
          </div>
          <div class="panel group">
            <h3>D é¡ï¼šåå­—</h3>
            <div class="opts" id="groupD"></div>
          </div>
        </div>
      </div>

      <div class="footerRow">
        <div class="score" id="score">å·²é€šé—œï¼š0ã€€ï½œã€€ç¸½é¡Œæ•¸ï¼š0</div>
        <div style="display:flex; gap:8px; align-items:center;">
          <span class="hint" id="pickHint">å››é¡éƒ½è¦æ€å…ˆå¯æäº¤</span>
          <button class="primary" id="btnSubmit" disabled>æäº¤</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
/* =========================
   è³‡æ–™èˆ‡è¦å‰‡
========================= */
const POLY_N = [3,4,5];
const TYPES = ["pyramid","prism"]; // è§’éŒ / è§’æŸ±

function shapeName(n, type){
  const map = {3:"ä¸‰",4:"å››",5:"äº”"};
  return map[n] + (type==="pyramid" ? "è§’éŒ" : "è§’æŸ±");
}
function facesCount(n, type){
  // nè§’éŒï¼šn+1ï¼›nè§’æŸ±ï¼šn+2
  return (type==="pyramid") ? (n + 1) : (n + 2);
}
function lateralFaceLabel(type){
  return (type==="pyramid") ? "å®ƒçš„å´é¢æ˜¯ä¸‰è§’å½¢" : "å®ƒçš„å´é¢æ˜¯å››é‚Šå½¢";
}
function solidTypeLabel(type){
  return (type==="pyramid") ? "å®ƒæ˜¯éŒ" : "å®ƒæ˜¯æŸ±é«”";
}
function imgPath(n, type){
  // images/pyramid3.svg, images/prism5.svg ...
  return `images/${type}${n}.svg`;
}

/* =========================
   å°å·¥å…·
========================= */
function shuffle(arr){
  const a = arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}
function sampleOne(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
function uniquePush(arr, item){ if(!arr.includes(item)) arr.push(item); }

/* =========================
   DOM
========================= */
const els = {
  meta: document.getElementById("shapeMeta"),
  img: document.getElementById("shapeImg"),
  status: document.getElementById("status"),
  score: document.getElementById("score"),
  pickHint: document.getElementById("pickHint"),
  submit: document.getElementById("btnSubmit"),
  newBtn: document.getElementById("btnNew"),
  resetBtn: document.getElementById("btnReset"),
  groupA: document.getElementById("groupA"),
  groupB: document.getElementById("groupB"),
  groupC: document.getElementById("groupC"),
  groupD: document.getElementById("groupD"),
};

/* =========================
   éŠæˆ²ç‹€æ…‹
========================= */
let current = null; // {n, type, answers}
let selected = {A:null,B:null,C:null,D:null};
let cleared = 0;
let total = 0;

function updateScore(){
  els.score.textContent = `å·²é€šé—œï¼š${cleared}ã€€ï½œã€€ç¸½é¡Œæ•¸ï¼š${total}`;
}

function clearGroups(){
  els.groupA.innerHTML = "";
  els.groupB.innerHTML = "";
  els.groupC.innerHTML = "";
  els.groupD.innerHTML = "";
}

function resetSelection(){
  selected = {A:null,B:null,C:null,D:null};
  document.querySelectorAll(".opt").forEach(o => o.classList.remove("selected"));
  els.submit.disabled = true;
  els.pickHint.textContent = "å››é¡éƒ½è¦æ€å…ˆå¯æäº¤";
  els.status.className = "status";
  els.status.textContent = "æç¤ºï¼šå››é¡éƒ½è¦æ€å…ˆå¯ä»¥æäº¤ã€‚";
  // ä¸æ­ç¤ºç­”æ¡ˆ
  els.meta.textContent = "è«‹è§€å¯Ÿå·¦é‚Šåœ–å½¢ï¼Œå®Œæˆå³é‚Šé…å°ã€‚";
}

function updateSubmitState(){
  const ok = selected.A && selected.B && selected.C && selected.D;
  els.submit.disabled = !ok;
  els.pickHint.textContent = ok ? "å·²é¸å››é¡ï¼Œå¯ä»¥æäº¤" : "å››é¡éƒ½è¦æ€å…ˆå¯æäº¤";
}

function makeOption(groupKey, text){
  const b = document.createElement("div");
  b.className = "opt";
  b.textContent = text;
  b.onclick = () => {
    selected[groupKey] = text;
    const groupEl = groupKey==="A"?els.groupA:groupKey==="B"?els.groupB:groupKey==="C"?els.groupC:els.groupD;
    [...groupEl.children].forEach(ch => ch.classList.toggle("selected", ch.textContent===text));
    updateSubmitState();
  };
  return b;
}

function buildCards(){
  const {n, type} = current;
  clearGroups();
  resetSelection();

  // correct answers
  const ansA = solidTypeLabel(type);
  const ansB = lateralFaceLabel(type);
  const ansC = `å®ƒç¸½å…±æœ‰ï¼ˆ${facesCount(n,type)}ï¼‰å€‹é¢`;
  const ansD = `å®ƒçš„åå­—æ˜¯ï¼ˆ${shapeName(n,type)}ï¼‰`;
  current.answers = {A:ansA,B:ansB,C:ansC,D:ansD};

  // Aï¼šå›ºå®šå…©å¼µ
  shuffle(["å®ƒæ˜¯æŸ±é«”","å®ƒæ˜¯éŒ"]).forEach(t => els.groupA.appendChild(makeOption("A", t)));

  // Bï¼šå›ºå®šå…©å¼µ
  shuffle(["å®ƒçš„å´é¢æ˜¯ä¸‰è§’å½¢","å®ƒçš„å´é¢æ˜¯å››é‚Šå½¢"]).forEach(t => els.groupB.appendChild(makeOption("B", t)));

  // Cï¼š1 correct + 2 å¹²æ“¾ï¼ˆå¾å…¶ä»–åœ–å½¢æŠ½ï¼‰
  const correctFace = facesCount(n,type);
  const facesPool = [];
  uniquePush(facesPool, correctFace);
  while(facesPool.length < 3){
    const n2 = sampleOne(POLY_N);
    const t2 = sampleOne(TYPES);
    const f2 = facesCount(n2,t2);
    if(f2 !== correctFace) uniquePush(facesPool, f2);
  }
  shuffle(facesPool.map(v => `å®ƒç¸½å…±æœ‰ï¼ˆ${v}ï¼‰å€‹é¢`))
    .forEach(t => els.groupC.appendChild(makeOption("C", t)));

  // Dï¼š1 correct + 3 å¹²æ“¾ï¼ˆå…­å€‹åå­—ä¹‹ä¸­æŠ½ï¼‰
  const namesPool = [];
  uniquePush(namesPool, shapeName(n,type));
  while(namesPool.length < 4){
    const n2 = sampleOne(POLY_N);
    const t2 = sampleOne(TYPES);
    const nm = shapeName(n2,t2);
    if(nm !== shapeName(n,type)) uniquePush(namesPool, nm);
  }
  shuffle(namesPool.map(v => `å®ƒçš„åå­—æ˜¯ï¼ˆ${v}ï¼‰`))
    .forEach(t => els.groupD.appendChild(makeOption("D", t)));
}

function loadShapeImage(n, type){
  els.img.src = imgPath(n, type);
  els.img.onerror = () => {
    els.status.className = "status bad";
    els.status.textContent = "åœ–ç‰‡è¼‰å…¥å¤±æ•—ï¼šè«‹ç¢ºèª images/ å…§æœ‰ pyramid3.svgã€prism4.svg ç­‰æª”æ¡ˆï¼Œæª”åå®Œå…¨ä¸€è‡´ï¼ˆå¤§å°å¯«è¦åŒï¼‰ã€‚";
  };
}

/* =========================
   å‡ºé¡Œï¼šéš¨æ©Ÿä¸‰ï½äº”è§’éŒï¼æŸ±
========================= */
function newQuestion(){
  const n = sampleOne(POLY_N);
  const type = sampleOne(TYPES);
  current = {n, type, answers:null};

  total += 1;
  updateScore();

  loadShapeImage(n, type);
  buildCards();
}

function submit(){
  if(!current?.answers) return;

  const wrong = [];
  if(selected.A !== current.answers.A) wrong.push("Aï¼ˆæŸ±é«”ï¼éŒï¼‰");
  if(selected.B !== current.answers.B) wrong.push("Bï¼ˆå´é¢å½¢ç‹€ï¼‰");
  if(selected.C !== current.answers.C) wrong.push("Cï¼ˆç¸½é¢æ•¸ï¼‰");
  if(selected.D !== current.answers.D) wrong.push("Dï¼ˆåå­—ï¼‰");

  if(wrong.length === 0){
    cleared += 1;
    updateScore();
    els.status.className = "status good";
    els.status.textContent = "ğŸ‰ é€šé—œæˆåŠŸï¼å››é¡éƒ½é…å°æ­£ç¢ºã€‚";
    // é€šé—œå¾Œå…ˆæ­ç¤ºåç¨±ï¼ˆå””æœƒæå‰æ³„é¡Œï¼‰
    els.meta.textContent = `æœ¬é—œåœ–å½¢ï¼š${shapeName(current.n, current.type)}`;
  }else{
    els.status.className = "status bad";
    els.status.textContent = `æœªé€šé—œï¼šä»¥ä¸‹é¡åˆ¥æœªé…å°æ­£ç¢º â†’ ${wrong.join("ã€")}ã€‚è«‹å†è©¦ã€‚`;
  }
}

/* =========================
   äº‹ä»¶
========================= */
els.submit.addEventListener("click", submit);
els.newBtn.addEventListener("click", newQuestion);
els.resetBtn.addEventListener("click", resetSelection);

// start
newQuestion();
</script>
</body>
</html>
