<!doctype html>
<html lang="zh-HK">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ç«‹é«”åœ–å½¢é…å°é€šé—œï¼ˆåœ–ç‰‡ç‰ˆï¼‰</title>

  <style>
    body{
      margin:0;
      font-family:"Noto Sans TC","PingFang TC","Microsoft JhengHei",system-ui,sans-serif;
      background:#f6f7fb;
      color:#111827;
    }
    header{
      padding:16px;
      background:#ffffff;
      border-bottom:1px solid #e5e7eb;
    }
    header h1{ margin:0; font-size:18px; }
    header p{ margin:6px 0 0; font-size:13px; color:#6b7280; }

    .wrap{ max-width:1100px; margin:0 auto; padding:16px; }
    .top{ display:grid; grid-template-columns: 1.1fr 1.9fr; gap:14px; }

    .panel{
      background:#ffffff;
      border:1px solid #e5e7eb;
      border-radius:14px;
      box-shadow:0 8px 20px rgba(0,0,0,.06);
    }

    .hd{
      padding:12px 14px;
      border-bottom:1px solid #e5e7eb;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    .bd{ padding:14px; }

    button{
      padding:8px 12px;
      border-radius:10px;
      border:1px solid #e5e7eb;
      background:#ffffff;
      cursor:pointer;
      font-size:14px;
    }
    button.primary{
      background:#2563eb;
      color:#ffffff;
      border:none;
    }
    button:disabled{ opacity:.5; cursor:not-allowed; }

    #imgWrap{
      height:360px;
      border:1px solid #e5e7eb;
      border-radius:12px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:#ffffff;
    }
    #shapeImg{ width:100%; height:100%; object-fit:contain; display:block; }

    .status{
      margin-top:10px;
      padding:10px;
      border-radius:10px;
      border:1px dashed #e5e7eb;
      font-size:14px;
      color:#374151;
      line-height:1.45;
    }
    .good{ background:#ecfdf5; border-color:#86efac; }
    .bad{ background:#fef2f2; border-color:#fecaca; }

    .grid{ display:grid; grid-template-columns: repeat(2, 1fr); gap:12px; }
    .group{ border:1px solid #e5e7eb; border-radius:12px; padding:12px; }
    .group h3{ margin:0 0 8px; font-size:14px; }

    .opts{ display:flex; flex-wrap:wrap; gap:8px; }
    .opt{
      padding:8px 10px;
      border:1px solid #e5e7eb;
      border-radius:10px;
      cursor:pointer;
      background:#ffffff;
      user-select:none;
    }
    .opt.selected{
      outline:2px solid rgba(37,99,235,.35);
      border-color:#2563eb;
    }

    .footer{
      padding:12px 14px;
      border-top:1px solid #e5e7eb;
      display:flex;
      justify-content:space-between;
      align-items:center;
      font-size:13px;
      color:#6b7280;
      gap:10px;
    }

    @media(max-width:900px){
      .top{ grid-template-columns:1fr; }
      #imgWrap{ height:300px; }
    }
  </style>
</head>

<body>
<header>
  <h1>ç«‹é«”åœ–å½¢é…å°é€šé—œ</h1>
  <p>è§€å¯Ÿå·¦é‚Šç«‹é«”åœ–å½¢åœ–ç‰‡ï¼Œå®Œæˆå³é‚Šå››é¡é…å°ã€‚å››é¡éƒ½æ­£ç¢ºå…ˆé€šé—œã€‚</p>
</header>

<div class="wrap">
  <div class="top">

    <!-- å·¦é‚Šåœ–ç‰‡ -->
    <div class="panel">
      <div class="hd">
        <div>
          <strong>ç«‹é«”åœ–å½¢</strong>
          <div style="font-size:13px;color:#6b7280;margin-top:4px;" id="meta">è«‹è§€å¯Ÿåœ–å½¢ï¼Œå®Œæˆé…å°ã€‚</div>
        </div>
        <div>
          <button id="btnNew">ä¸‹ä¸€é¡Œ</button>
          <button id="btnReset">é‡è¨­</button>
        </div>
      </div>
      <div class="bd">
        <div id="imgWrap">
          <img id="shapeImg" alt="ç«‹é«”åœ–å½¢" />
        </div>
        <div id="status" class="status">æç¤ºï¼šå››é¡éƒ½è¦æ€ï¼Œå…ˆå¯ä»¥æäº¤ã€‚</div>
      </div>
    </div>

    <!-- å³é‚Šé…å° -->
    <div class="panel">
      <div class="hd">
        <strong>å››é¡å­—å¡é…å°</strong>
      </div>
      <div class="bd">
        <div class="grid">
          <div class="group">
            <h3>A é¡ï¼šæŸ±é«”ï¼éŒ</h3>
            <div class="opts" id="A"></div>
          </div>
          <div class="group">
            <h3>B é¡ï¼šå´é¢å½¢ç‹€</h3>
            <div class="opts" id="B"></div>
          </div>
          <div class="group">
            <h3>C é¡ï¼šç¸½é¢æ•¸</h3>
            <div class="opts" id="C"></div>
          </div>
          <div class="group">
            <h3>D é¡ï¼šåå­—</h3>
            <div class="opts" id="D"></div>
          </div>
        </div>
      </div>
      <div class="footer">
        <span id="score">å·²é€šé—œï¼š0 ï½œ ç¸½é¡Œæ•¸ï¼š0</span>
        <div style="display:flex; gap:8px; align-items:center;">
          <span id="hint">å››é¡éƒ½è¦æ€å…ˆå¯æäº¤</span>
          <button class="primary" id="btnSubmit" disabled>æäº¤</button>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
/* ===== é¡Œåº« ===== */
const Ns = [3,4,5];
const Types = ["pyramid","prism"];
const zhN = {3:"ä¸‰",4:"å››",5:"äº”"};

function shapeName(n,t){ return zhN[n] + (t==="pyramid" ? "è§’éŒ" : "è§’æŸ±"); }
function faces(n,t){ return t==="pyramid" ? (n+1) : (n+2); }
function imgPath(n,t){ return `${t}${n}.svg`; } // åŒä¸€å±¤

/* ===== ç‹€æ…‹ ===== */
let current = null;
let cleared = 0, total = 0;
let pick = {A:null,B:null,C:null,D:null};

/* ===== DOM ===== */
const img = document.getElementById("shapeImg");
const status = document.getElementById("status");
const score = document.getElementById("score");
const submit = document.getElementById("btnSubmit");
const btnNew = document.getElementById("btnNew");
const btnReset = document.getElementById("btnReset");
const hint = document.getElementById("hint");
const meta = document.getElementById("meta");
const groups = {A:document.getElementById("A"), B:document.getElementById("B"), C:document.getElementById("C"), D:document.getElementById("D")};

/* ===== å·¥å…· ===== */
function shuffle(arr){
  const a = arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}
function sample(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

function setStatus(type, text){
  status.className = "status" + (type ? (" " + type) : "");
  status.textContent = text;
}

function resetPick(){
  pick = {A:null,B:null,C:null,D:null};
  document.querySelectorAll(".opt").forEach(o=>o.classList.remove("selected"));
  submit.disabled = true;
  hint.textContent = "å››é¡éƒ½è¦æ€å…ˆå¯æäº¤";
  meta.textContent = "è«‹è§€å¯Ÿåœ–å½¢ï¼Œå®Œæˆé…å°ã€‚";
  setStatus("", "æç¤ºï¼šå››é¡éƒ½è¦æ€ï¼Œå…ˆå¯ä»¥æäº¤ã€‚");
}

function makeOpt(groupKey, text){
  const d = document.createElement("div");
  d.className = "opt";
  d.textContent = text;
  d.onclick = ()=>{
    pick[groupKey] = text;
    [...groups[groupKey].children].forEach(c=>c.classList.toggle("selected", c===d));
    const ok = pick.A && pick.B && pick.C && pick.D;
    submit.disabled = !ok;
    hint.textContent = ok ? "å·²é¸å››é¡ï¼Œå¯ä»¥æäº¤" : "å››é¡éƒ½è¦æ€å…ˆå¯æäº¤";
  };
  return d;
}

/* ===== ç”Ÿæˆæ¯é¡é¸é …ï¼ˆä¿è­‰åŒ…å«æ­£ç¢ºç­”æ¡ˆï¼‰ ===== */
function build(){
  for(const k in groups) groups[k].innerHTML = "";
  resetPick();

  const {n,t} = current;

  // æ­£ç¢ºç­”æ¡ˆï¼ˆå­—ä¸²è¦åŒé¸é …å®Œå…¨ä¸€è‡´ï¼‰
  const ans = {
    A: (t==="pyramid") ? "å®ƒæ˜¯éŒ" : "å®ƒæ˜¯æŸ±é«”",
    B: (t==="pyramid") ? "å®ƒçš„å´é¢æ˜¯ä¸‰è§’å½¢" : "å®ƒçš„å´é¢æ˜¯å››é‚Šå½¢",
    C: `å®ƒç¸½å…±æœ‰ï¼ˆ${faces(n,t)}ï¼‰å€‹é¢`,
    D: `å®ƒçš„åå­—æ˜¯ï¼ˆ${shapeName(n,t)}ï¼‰`
  };
  current.ans = ans;

  // Aï¼šå›ºå®šå…©å¼µï¼ˆä¸€å®šæœ‰ç­”æ¡ˆï¼‰
  shuffle(["å®ƒæ˜¯æŸ±é«”","å®ƒæ˜¯éŒ"]).forEach(v=>groups.A.appendChild(makeOpt("A", v)));

  // Bï¼šå›ºå®šå…©å¼µï¼ˆä¸€å®šæœ‰ç­”æ¡ˆï¼‰
  shuffle(["å®ƒçš„å´é¢æ˜¯ä¸‰è§’å½¢","å®ƒçš„å´é¢æ˜¯å››é‚Šå½¢"]).forEach(v=>groups.B.appendChild(makeOpt("B", v)));

  // Cï¼šæ­£ç¢º + 2 å€‹å¹²æ“¾ï¼ˆå”¯ä¸€ã€ä¸€å®šåŒ…å«æ­£ç¢ºï¼‰
  const correctFaces = faces(n,t);
  const poolFaces = new Set([correctFaces]);
  while(poolFaces.size < 3){
    const n2 = sample(Ns);
    const t2 = sample(Types);
    poolFaces.add(faces(n2,t2));
  }
  shuffle([...poolFaces].map(v=>`å®ƒç¸½å…±æœ‰ï¼ˆ${v}ï¼‰å€‹é¢`))
    .forEach(v=>groups.C.appendChild(makeOpt("C", v)));

  // Dï¼šæ­£ç¢ºåå­— + 3 å€‹å¹²æ“¾ï¼ˆâœ…ä¿®æ­£ï¼šä¸€å®šåŒ…å«æ­£ç¢ºï¼‰
  const correctName = shapeName(n,t);
  const poolNames = new Set([correctName]);
  while(poolNames.size < 4){
    const n2 = sample(Ns);
    const t2 = sample(Types);
    poolNames.add(shapeName(n2,t2));
  }
  shuffle([...poolNames].map(v=>`å®ƒçš„åå­—æ˜¯ï¼ˆ${v}ï¼‰`))
    .forEach(v=>groups.D.appendChild(makeOpt("D", v)));
}

/* ===== å‡ºé¡Œ ===== */
function newQ(){
  current = { n: sample(Ns), t: sample(Types), ans:null };
  total++;
  score.textContent = `å·²é€šé—œï¼š${cleared} ï½œ ç¸½é¡Œæ•¸ï¼š${total}`;

  img.src = imgPath(current.n, current.t);
  img.onerror = ()=>{
    setStatus("bad", "åœ–ç‰‡æœªæˆåŠŸè¼‰å…¥ã€‚è«‹ç¢ºèª pyramid3.svgã€prism4.svg ç­‰åœ–ç‰‡èˆ‡ index.html æ”¾åœ¨åŒä¸€å±¤ï¼Œä¸¦å·² commitã€‚");
  };

  build();
}

/* ===== æäº¤ ===== */
function submitAns(){
  const wrong = Object.keys(current.ans).filter(k => pick[k] !== current.ans[k]);
  if(wrong.length === 0){
    cleared++;
    score.textContent = `å·²é€šé—œï¼š${cleared} ï½œ ç¸½é¡Œæ•¸ï¼š${total}`;
    setStatus("good", "ğŸ‰ é€šé—œæˆåŠŸï¼");
    meta.textContent = `æœ¬é—œåœ–å½¢ï¼š${shapeName(current.n, current.t)}`;
  }else{
    setStatus("bad", "æœªé€šé—œï¼šæœ‰ä¸€é¡æˆ–ä»¥ä¸Šæœªé¸å°ï¼Œè«‹å†è©¦ã€‚");
  }
}

/* ===== äº‹ä»¶ ===== */
btnNew.onclick = newQ;
btnReset.onclick = resetPick;
submit.onclick = submitAns;

/* ===== é–‹å§‹ ===== */
newQ();
</script>
</body>
</html>
